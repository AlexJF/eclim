<?xml version="1.0" encoding="UTF-8"?>
<!--
  - Copyright (c) 2005 - 2008
  -
  - Licensed under the Apache License, Version 2.0 (the "License");
  - you may not use this file except in compliance with the License.
  - You may obtain a copy of the License at
  -
  -      http://www.apache.org/licenses/LICENSE-2.0
  -
  - Unless required by applicable law or agreed to in writing, software
  - distributed under the License is distributed on an "AS IS" BASIS,
  - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  - See the License for the specific language governing permissions and
  - limitations under the License.
  -
  - Author: Eric Van Dewoestine
  -->
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V2.0//EN"
  "http://forrest.apache.org/dtd/document-v20.dtd">

<document>
  <header>
    <title>Django</title>
    <authors>
      <person name="Eric Van Dewoestine" email="ervandew@gmail.com"/>
    </authors>
  </header>
  <body>
    <anchor id="DjangoManage"/>
    <section id="manage">
      <title>Django manage.py</title>
      <p>
        For each project you create with the django framework, django provides
        you with a manage.py which can be used to perform various tasks.  To
        make the invocation of the manage.py script even easier, eclim provides
        the command <strong>:DjangoManage</strong> which can be invoked from any
        file in the same directory as your manage.py or in any of the child
        directories.
      </p>
      <p>
        <strong>:DjangoManage</strong> supports all the same commands as
        manage.py and supports command line completion of command names and app
        names where supported.
      </p>
      <p>
        Several of the manage.py commands simply perform an action without
        generating much if any output.  However there is also a set of commands
        which generate sql statements.  For all of these commands, instead of
        just running the command in a shell, <strong>:DjangoManage</strong> will
        run the command and populate a new buffer with the resulting output and
        set the proper file type.
      </p>
      <p>
        <strong>Configuration</strong>
      </p>
      <p><strong>Vim Variables:</strong></p>
      <ul>
        <li>
          <anchor id="EclimPythonInterpreter"/>
          <strong>g:EclimPythonInterpreter</strong> = 'python'
        </li>
        <li>
          <anchor id="EclimDjangoAdmin"/>
          <strong>g:EclimDjangoAdmin</strong> = 'django-admin.py'
        </li>
      </ul>
    </section>

    <section id="code">
      <title>Django python support</title>
      <anchor id="DjangoTemplateOpen"/>
      <p><strong>Locating templates</strong></p>
      <p>
        The command <strong>:DjangoTemplateOpen</strong> supports finding and
        opening a template referenced under the cursor.<br/>
        Ex.
      </p>
      <source>
        # w/ cursor on 'mytemplates/mytemplate.html'
        return render_to_response('mytemplates/mytemplate.html', ...)
      </source>

      <anchor id="DjangoViewOpen"/>
      <p><strong>Locating views</strong></p>
      <p>
        The command <strong>:DjangoViewOpen</strong> supports finding and
        opening a view referenced under the cursor.<br/>
        Ex.
      </p>
      <source>
        <![CDATA[
          # w/ cursor on 'myproject.myapp.views' or 'my_view' on the second line.
          urlpatterns = patterns('myproject.myapp.views',
              (r'^$', 'my_view'),
          )
        ]]>
      </source>

      <anchor id="DjangoContextOpen"/>
      <p><strong>Contextually locate file</strong></p>
      <p>
        The command <strong>:DjangoContextOpen</strong> supports executing
        <strong>:DjangoViewOpen</strong>, <strong>:DjangoTemplateOpen</strong>,
        or <strong>:PythonFindDefinition</strong> depending on the context of
        the text under the cursor.
      </p>
    </section>

    <section id="template">
      <title>Django html template support</title>
      <p><strong>Syntax</strong></p>
      <p>
        Vim ships with a syntax file for django html template files, but eclim
        builds on that base to support highlighting of user defined tags and
        filters (see the <a href="#configuration">configuration section</a>
        below.
      </p>

      <p><strong>Indent</strong></p>
      <p>
        Using the same settings as the enhanced syntax file, eclim also ships
        with an indent script which provides indentation support all of the
        default django tags and any user defined tags that have been configured.
      </p>

      <p><strong>Match It</strong></p>
      <p>
        Again, using the same set of variables, eclim set the necessary
        variables to allow proper matchit.vim support for django default and
        user defined tags.
      </p>

      <p><strong>End Tag Completion</strong></p>
      <p>
        Using the
        <a href="#HtmlDjangoUserBodyElements">
          <strong>g:HtmlDjangoUserBodyElements</strong>
        </a>
        setting along with the pre-configured default list of body elements,
        eclim includes support for auto completion of ending template tags when
        you type a '%' preceded by a '{':
      </p>

      <anchor id="DjangoFind"/>
      <p><strong>Contextual Find</strong></p>
      <p>
        While editing django html templates, the command
        <strong>:DjangoFind</strong> which will attempt to locate the relevant
        resource depending on what is under the cursor:
      </p>
      <ul>
        <li>
          If on a user defined tag, attempt to find the tag definition within
          the python tag definition file.<br/>
          Ex.
          <source>
            {# w/ cursor on 'mytag' #}
            {% mytag somearg %}
          </source>
        </li>
        <li>
          If on a user defined filter, attempt to find the filter definition
          within the python filter definition file.<br/>
          Ex.
          <source>
            {# w/ cursor on 'myfilter' #}
            {{ somevalue|myfilter }}
          </source>
        </li>
        <li>
          If on the tag/filter definition portion of of a 'load' tag, attempt to
          find the definition file.<br/>
          Ex.
          <source>
            {# w/ cursor on 'mytags' #}
            {% load mytags %}
          </source>
        </li>
        <li>
          If on a reference to a template for ethier an 'extends' or 'include'
          tag, attempt to find that template file.<br/>
          Ex.
          <source>
            {# w/ cursor on 'include/mytemplate.html' #}
            {% include "include/mytemplate.html" %}
          </source>
        </li>
        <li>
          If on static file reference, as defined in a 'src' or 'href' attribute
          of an element, attempt to find that static file.<br/>
          Ex.
          <source>
            {# w/ cursor on '/css/my.css' #}
            &lt;link rel="stylesheet" href="/css/my.css" type="text/css" /&gt;
          </source>
          Note: this functionality requires that
          <strong>g:EclimDjangoStaticPaths</strong> is set to a list of absolute
          or django project relative (relative to directory containing manage.py
          and settings.py) directories.<br/>
          Ex.
          <source>
            let g:EclimDjangoStaticPaths = ["../static/"]
          </source>
        </li>
      </ul>

      <anchor id="configuration"/>
      <p>
        <strong>Configuration</strong>
      </p>
      <p><strong>Vim Variables:</strong></p>
      <ul>
        <li>
          <anchor id="HtmlDjangoUserBodyElements"/>
          <strong>g:HtmlDjangoUserBodyElements</strong><br/>
          List of lists, where each list contains the name of the start and end
          tag, as well as any intermediary tags of any custom tags which have a
          body.<br/>
          Ex.
          <source>
            let g:HtmlDjangoUserBodyElements = [
                \ ['repeat', 'endrepeat'],
                \ ['try', 'except', 'finally', 'endtry'],
              \ ]
          </source>
          This setting is used for indentation of the custom tag's body, as well
          as arguments for proper matchit support, end tag completion, and
          syntax highlighting.
        </li>
        <li>
          <anchor id="HtmlDjangoUserTags"/>
          <strong>g:HtmlDjangoUserTags</strong><br/>
          This setting is a list of any non-body tags which don't require
          indentation or matchit support.  The items configured here will be
          used for syntax highlighting.
        </li>
        <li>
          <anchor id="HtmlDjangoUserFilters"/>
          <strong>g:HtmlDjangoUserFilters</strong><br/>
          This settings contains a list of any user defined django filters.  It
          is currently used for syntax highlighting.
        </li>
        <li>
          <anchor id="HtmlDjangoCompleteEndTag"/>
          <strong>g:HtmlDjangoCompleteEndTag</strong>(Default: 1)<br/>
          When set to 0, disables the auto completion of end tags.
        </li>
        <li>
          <anchor id="EclimDjangoStaticPaths"/>
          <strong>g:EclimDjangoStaticPaths</strong><br/>
          Used as a list of directories to search when looking for static files
          (js, css, etc). Expected to be a list of absolute or django project
          relative (relative to directory containing manage.py and settings.py)
          directories.<br/>
          Ex.
          <source>
            let g:EclimDjangoStaticPaths = ["../static/"]
          </source>
        </li>
        <li>
          <anchor id="EclimDjangoFindAction"/>
          <strong>g:EclimDjangoFindAction</strong> (Default: "split")<br/>
          For <strong>:DjangoFind</strong> and
          <strong>:DjangoTemplateOpen</strong>, used as the action to perform on
          the file found.
        </li>
      </ul>
    </section>
  </body>
</document>
